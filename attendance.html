<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Attendance Management System</title>
    <style>
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: 'Inter', 'SF Pro Display', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
    background: 
        radial-gradient(circle at 25% 25%, rgba(59, 130, 246, 0.1) 0%, transparent 50%),
        radial-gradient(circle at 75% 75%, rgba(30, 64, 175, 0.1) 0%, transparent 50%),
        linear-gradient(145deg, #f8fafc 0%, #e2e8f0 50%, #cbd5e1 100%);
    min-height: 100vh;
    display: flex;
    align-items: center;
    justify-content: center;
    color: #1e293b;
    position: relative;
    overflow-x: hidden;
}

body::before {
    content: '';
    position: fixed;
    top: -50%;
    left: -50%;
    width: 200%;
    height: 200%;
    background: 
        conic-gradient(from 0deg at 50% 50%, 
            rgba(59, 130, 246, 0.02) 0deg,
            rgba(30, 64, 175, 0.03) 90deg,
            rgba(59, 130, 246, 0.02) 180deg,
            rgba(30, 64, 175, 0.01) 270deg,
            rgba(59, 130, 246, 0.02) 360deg);
    animation: rotate-background 20s linear infinite;
    pointer-events: none;
    z-index: -1;
}

@keyframes rotate-background {
    from { transform: rotate(0deg); }
    to { transform: rotate(360deg); }
}

.container {
    background: rgba(255, 255, 255, 0.85);
    backdrop-filter: blur(40px) saturate(200%);
    border-radius: 32px;
    box-shadow: 
        0 25px 50px -12px rgba(0, 0, 0, 0.15),
        0 0 0 1px rgba(255, 255, 255, 0.1),
        inset 0 1px 0 rgba(255, 255, 255, 0.8);
    width: 95%;
    max-width: 1500px;
    min-height: 800px;
    overflow: hidden;
    position: relative;
    border: 1px solid rgba(226, 232, 240, 0.2);
    animation: container-appear 1s ease-out;
}

@keyframes container-appear {
    from {
        opacity: 0;
        transform: scale(0.95) translateY(20px);
    }
    to {
        opacity: 1;
        transform: scale(1) translateY(0);
    }
}

.container::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 4px;
    background: linear-gradient(90deg, 
        #3b82f6 0%, 
        #8b5cf6 25%, 
        #06b6d4 50%, 
        #10b981 75%, 
        #3b82f6 100%);
    background-size: 200% 100%;
    animation: shimmer 3s ease-in-out infinite;
}

@keyframes shimmer {
    0%, 100% { background-position: 200% 0; }
    50% { background-position: -200% 0; }
}

.login-section {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 120px 80px;
    text-align: center;
    background: linear-gradient(135deg, #3b82f6 0%, #1e40af 35%, #3730a3 70%, #1e40af 100%);
    color: white;
    position: relative;
    overflow: hidden;
    min-height: 90vh;
}

.login-section::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: 
        radial-gradient(circle at 20% 30%, rgba(255, 255, 255, 0.1) 0%, transparent 60%),
        radial-gradient(circle at 80% 70%, rgba(255, 255, 255, 0.05) 0%, transparent 60%),
        radial-gradient(circle at 50% 50%, rgba(59, 130, 246, 0.1) 0%, transparent 80%);
}

@keyframes pulse-glow {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.8; }
}

.login-section::after {
    content: '';
    position: absolute;
    width: 200px;
    height: 200px;
    background: linear-gradient(45deg, rgba(255, 255, 255, 0.1), transparent);
    border-radius: 50%;
    top: 10%;
    right: 10%;
    animation: float-circle 8s ease-in-out infinite;
}

@keyframes float-circle {
    0%, 100% { transform: translateY(0) rotate(0deg); }
    50% { transform: translateY(-20px) rotate(180deg); }
}

.login-section h1 {
    color: white;
    margin-bottom: 40px;
    font-size: 4.5rem;
    font-weight: 900;
    letter-spacing: -0.02em;
    position: relative;
    z-index: 1;
    text-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
    background: linear-gradient(135deg, #ffffff 0%, #e0e7ff 100%);
    background-clip: text;
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
}


.login-section p {
    color: rgba(255, 255, 255, 0.9);
    margin-bottom: 50px;
    font-size: 1.4rem;
    line-height: 1.8;
    max-width: 650px;
    position: relative;
    z-index: 1;
    font-weight: 400;
}

.google-login-btn {
    background: linear-gradient(135deg, #ffffff 0%, #f1f5f9 100%);
    color: #1e40af;
    border: none;
    padding: 22px 48px;
    border-radius: 24px;
    font-size: 1.2rem;
    font-weight: 700;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 18px;
    transition: all 0.5s cubic-bezier(0.23, 1, 0.32, 1);
    box-shadow: 
        0 20px 40px -12px rgba(0, 0, 0, 0.4),
        0 0 0 1px rgba(255, 255, 255, 0.1);
    position: relative;
    z-index: 1;
    overflow: hidden;
}

.google-login-btn::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(59, 130, 246, 0.1), transparent);
    transition: left 0.8s ease;
}

.google-login-btn:hover::before {
    left: 100%;
}

.google-login-btn:hover {
    background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
    transform: translateY(-6px) scale(1.02);
    box-shadow: 
        0 30px 60px -12px rgba(0, 0, 0, 0.5),
        0 0 0 1px rgba(255, 255, 255, 0.2);
}

.main-app {
    display: none;
    padding: 60px;
    background: 
        linear-gradient(135deg, rgba(255, 255, 255, 0.9) 0%, rgba(248, 250, 252, 0.9) 100%),
        url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grain" width="100" height="100" patternUnits="userSpaceOnUse"><circle cx="25" cy="25" r="0.5" fill="%23f1f5f9" opacity="0.1"/><circle cx="75" cy="75" r="0.3" fill="%23e2e8f0" opacity="0.1"/></pattern></defs><rect width="100%" height="100%" fill="url(%23grain)"/></svg>');
    position: relative;
    min-height: 100vh;
}

.main-app::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: 
        radial-gradient(circle at 15% 25%, rgba(59, 130, 246, 0.03) 0%, transparent 50%),
        radial-gradient(circle at 85% 75%, rgba(30, 64, 175, 0.03) 0%, transparent 50%);
    pointer-events: none;
    animation: bg-shift 15s ease-in-out infinite;
}

@keyframes bg-shift {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.7; }
}

.header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 60px;
    padding: 40px 0;
    border-bottom: 1px solid rgba(59, 130, 246, 0.1);
    position: relative;
    z-index: 1;
}

.header::after {
    content: '';
    position: absolute;
    bottom: -1px;
    left: 0;
    width: 150px;
    height: 6px;
    background: linear-gradient(90deg, #3b82f6 0%, #8b5cf6 50%, #06b6d4 100%);
    border-radius: 3px;
    box-shadow: 0 0 20px rgba(59, 130, 246, 0.4);
    animation: header-line-pulse 2s ease-in-out infinite;
}

@keyframes header-line-pulse {
    0%, 100% { transform: scaleX(1); opacity: 1; }
    50% { transform: scaleX(1.1); opacity: 0.8; }
}

.header h1 {
    font-size: 3rem;
    font-weight: 900;
    color: #1e293b;
    letter-spacing: -0.02em;
    text-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
    position: relative;
}

.header h1::before {
    content: '';
    position: absolute;
    top: -10px;
    left: -10px;
    right: -10px;
    bottom: -10px;
    background: linear-gradient(45deg, rgba(59, 130, 246, 0.05), transparent, rgba(30, 64, 175, 0.05));
    border-radius: 12px;
    z-index: -1;
    animation: header-glow 4s ease-in-out infinite;
}

@keyframes header-glow {
    0%, 100% { opacity: 0; }
    50% { opacity: 1; }
}

.user-info {
    display: flex;
    align-items: center;
    gap: 24px;
    padding: 16px 28px;
    background: rgba(59, 130, 246, 0.05);
    backdrop-filter: blur(20px);
    border-radius: 28px;
    border: 1px solid rgba(59, 130, 246, 0.1);
    box-shadow: 
        0 12px 30px -8px rgba(59, 130, 246, 0.2),
        inset 0 1px 0 rgba(255, 255, 255, 0.5);
    transition: all 0.4s ease;
}

.user-info:hover {
    transform: translateY(-2px);
    box-shadow: 
        0 20px 40px -8px rgba(59, 130, 246, 0.25),
        inset 0 1px 0 rgba(255, 255, 255, 0.7);
}

.user-avatar {
    width: 56px;
    height: 56px;
    border-radius: 50%;
    border: 3px solid #3b82f6;
    object-fit: cover;
    box-shadow: 0 8px 25px rgba(59, 130, 246, 0.3);
    transition: all 0.4s ease;
}

.user-avatar:hover {
    transform: scale(1.1);
    box-shadow: 0 12px 35px rgba(59, 130, 246, 0.4);
}

.logout-btn {
    background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
    color: white;
    border: none;
    padding: 14px 28px;
    border-radius: 18px;
    cursor: pointer;
    font-weight: 700;
    transition: all 0.5s cubic-bezier(0.23, 1, 0.32, 1);
    box-shadow: 0 8px 25px -6px rgba(239, 68, 68, 0.4);
    text-transform: uppercase;
    letter-spacing: 0.8px;
    font-size: 0.95rem;
    position: relative;
    overflow: hidden;
}

.logout-btn::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
    transition: left 0.6s ease;
}

.logout-btn:hover::before {
    left: 100%;
}

.logout-btn:hover {
    background: linear-gradient(135deg, #dc2626 0%, #b91c1c 100%);
    transform: translateY(-3px) scale(1.02);
    box-shadow: 0 15px 40px -6px rgba(239, 68, 68, 0.5);
}

.tabs {
    display: flex;
    gap: 8px;
    margin-bottom: 60px;
    background: rgba(248, 250, 252, 0.7);
    backdrop-filter: blur(20px);
    padding: 12px;
    border-radius: 28px;
    border: 1px solid rgba(59, 130, 246, 0.08);
    box-shadow: 
        0 12px 40px -12px rgba(0, 0, 0, 0.1),
        inset 0 1px 0 rgba(255, 255, 255, 0.6);
    position: relative;
    z-index: 1;
}

.tabs::before {
    content: '';
    position: absolute;
    inset: 0;
    padding: 1px;
    background: linear-gradient(135deg, rgba(59, 130, 246, 0.1), rgba(30, 64, 175, 0.05));
    border-radius: inherit;
    mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
    mask-composite: subtract;
}

.tab {
    padding: 18px 36px;
    background: transparent;
    border: none;
    border-radius: 20px;
    cursor: pointer;
    transition: all 0.5s cubic-bezier(0.23, 1, 0.32, 1);
    font-weight: 600;
    color: #64748b;
    font-size: 1rem;
    position: relative;
    overflow: hidden;
    text-transform: uppercase;
    letter-spacing: 0.8px;
}

.tab::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(135deg, #3b82f6 0%, #1e40af 100%);
    opacity: 0;
    transition: all 0.5s ease;
    z-index: -1;
    transform: scale(0.8);
}

.tab.active::before {
    opacity: 1;
    transform: scale(1);
}

.tab.active {
    color: white;
    box-shadow: 0 8px 32px -8px rgba(59, 130, 246, 0.4);
    transform: translateY(-2px);
}

.tab:not(.active):hover {
    background: rgba(59, 130, 246, 0.08);
    color: #3b82f6;
    transform: translateY(-1px);
    box-shadow: 0 4px 20px -4px rgba(59, 130, 246, 0.2);
}

.tab-content {
    display: none;
    animation: tab-slide-in 0.6s cubic-bezier(0.23, 1, 0.32, 1);
    position: relative;
    z-index: 1;
}

.tab-content.active {
    display: block;
}

@keyframes tab-slide-in {
    from { 
        opacity: 0; 
        transform: translateY(20px) scale(0.98); 
    }
    to { 
        opacity: 1; 
        transform: translateY(0) scale(1); 
    }
}

.tab-content h2 {
    color: #1e293b;
    margin-bottom: 40px;
    font-size: 2.2rem;
    font-weight: 800;
    position: relative;
    padding-bottom: 20px;
}

.tab-content h2::after {
    content: '';
    position: absolute;
    bottom: 0;
    left: 0;
    width: 100px;
    height: 6px;
    background: linear-gradient(90deg, #3b82f6 0%, #8b5cf6 50%, #06b6d4 100%);
    border-radius: 3px;
    box-shadow: 0 0 15px rgba(59, 130, 246, 0.4);
}

.form-group {
    margin-bottom: 32px;
    position: relative;
}

.form-group label {
    display: block;
    margin-bottom: 12px;
    font-weight: 600;
    color: #374151;
    font-size: 1.05rem;
    transition: color 0.3s ease;
}

.form-group input {
    width: 100%;
    padding: 20px 28px;
    border: 2px solid rgba(59, 130, 246, 0.1);
    border-radius: 18px;
    font-size: 1.05rem;
    transition: all 0.4s cubic-bezier(0.23, 1, 0.32, 1);
    background: rgba(248, 250, 252, 0.6);
    backdrop-filter: blur(10px);
    color: #374151;
    position: relative;
}

.form-group input:focus {
    outline: none;
    border-color: #3b82f6;
    background: rgba(255, 255, 255, 0.9);
    box-shadow: 
        0 0 0 4px rgba(59, 130, 246, 0.1), 
        0 8px 30px -8px rgba(59, 130, 246, 0.2);
    transform: translateY(-2px);
}

.form-group input:focus + label {
    color: #3b82f6;
}

.form-group input::placeholder {
    color: #94a3b8;
    transition: opacity 0.3s ease;
}

.form-group input:focus::placeholder {
    opacity: 0.7;
}

.btn {
    background: linear-gradient(135deg, #3b82f6 0%, #1e40af 100%);
    color: white;
    border: none;
    padding: 18px 36px;
    border-radius: 18px;
    cursor: pointer;
    font-size: 1.05rem;
    font-weight: 700;
    transition: all 0.5s cubic-bezier(0.23, 1, 0.32, 1);
    margin-right: 20px;
    box-shadow: 0 8px 32px -8px rgba(59, 130, 246, 0.4);
    position: relative;
    overflow: hidden;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.btn::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
    transition: left 0.8s ease;
}

.btn:hover::before {
    left: 100%;
}

.btn::after {
    content: '';
    position: absolute;
    inset: 0;
    background: linear-gradient(135deg, rgba(255, 255, 255, 0.1), transparent, rgba(255, 255, 255, 0.1));
    opacity: 0;
    transition: opacity 0.3s ease;
}

.btn:hover::after {
    opacity: 1;
}

.btn:hover {
    background: linear-gradient(135deg, #1e40af 0%, #1e3a8a 100%);
    transform: translateY(-3px) scale(1.02);
    box-shadow: 0 15px 50px -8px rgba(59, 130, 246, 0.5);
}

.btn-danger {
    background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
    box-shadow: 0 8px 32px -8px rgba(239, 68, 68, 0.4);
}

.btn-danger:hover {
    background: linear-gradient(135deg, #dc2626 0%, #b91c1c 100%);
    box-shadow: 0 15px 50px -8px rgba(239, 68, 68, 0.5);
}

.btn-success {
    background: linear-gradient(135deg, #10b981 0%, #059669 100%);
    box-shadow: 0 8px 32px -8px rgba(16, 185, 129, 0.4);
}

.btn-success:hover {
    background: linear-gradient(135deg, #059669 0%, #047857 100%);
    box-shadow: 0 15px 50px -8px rgba(16, 185, 129, 0.5);
}

.students-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(400px, 1fr));
    gap: 32px;
    margin-top: 50px;
}

.student-card {
    background: linear-gradient(135deg, rgba(255, 255, 255, 0.9) 0%, rgba(248, 250, 252, 0.9) 100%);
    backdrop-filter: blur(20px);
    border-radius: 24px;
    padding: 36px;
    border: 1px solid rgba(59, 130, 246, 0.08);
    transition: all 0.5s cubic-bezier(0.23, 1, 0.32, 1);
    position: relative;
    overflow: hidden;
    box-shadow: 0 12px 40px -12px rgba(0, 0, 0, 0.1);
}

.student-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 6px;
    background: linear-gradient(90deg, #3b82f6 0%, #8b5cf6 50%, #06b6d4 100%);
    transform: scaleX(0);
    transition: transform 0.5s ease;
    transform-origin: left;
}

.student-card::after {
    content: '';
    position: absolute;
    top: 20px;
    right: 20px;
    width: 8px;
    height: 8px;
    background: rgba(59, 130, 246, 0.3);
    border-radius: 50%;
    transition: all 0.4s ease;
}

.student-card:hover {
    border-color: rgba(59, 130, 246, 0.2);
    transform: translateY(-8px) scale(1.02);
    box-shadow: 0 25px 60px -12px rgba(59, 130, 246, 0.2);
}

.student-card:hover::before {
    transform: scaleX(1);
}

.student-card:hover::after {
    background: #3b82f6;
    box-shadow: 0 0 20px rgba(59, 130, 246, 0.5);
}

.student-card h3 {
    color: #1e293b;
    margin-bottom: 24px;
    font-size: 1.5rem;
    font-weight: 800;
    position: relative;
}

.student-card h3::before {
    content: '';
    position: absolute;
    bottom: -8px;
    left: 0;
    width: 40px;
    height: 3px;
    background: linear-gradient(90deg, #3b82f6, #8b5cf6);
    border-radius: 2px;
    transition: width 0.4s ease;
}

.student-card:hover h3::before {
    width: 80px;
}

.student-card p {
    color: #64748b;
    margin-bottom: 12px;
    font-size: 1.05rem;
    line-height: 1.7;
}

.student-actions {
    display: flex;
    gap: 20px;
    margin-top: 30px;
}

.attendance-table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 50px;
    background: linear-gradient(135deg, rgba(255, 255, 255, 0.9) 0%, rgba(248, 250, 252, 0.9) 100%);
    backdrop-filter: blur(20px);
    border-radius: 24px;
    overflow: hidden;
    box-shadow: 0 20px 50px -12px rgba(0, 0, 0, 0.12);
    border: 1px solid rgba(59, 130, 246, 0.08);
    position: relative;
}

.attendance-table::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 6px;
    background: linear-gradient(90deg, #3b82f6 0%, #8b5cf6 50%, #06b6d4 100%);
}

.attendance-table th,
.attendance-table td {
    padding: 24px 28px;
    text-align: left;
    border-bottom: 1px solid rgba(226, 232, 240, 0.2);
    transition: all 0.3s ease;
}

.attendance-table th {
    background: linear-gradient(135deg, #3b82f6 0%, #1e40af 100%);
    color: white;
    font-weight: 700;
    font-size: 1.05rem;
    letter-spacing: 0.5px;
    text-transform: uppercase;
    position: relative;
}

.attendance-table th::after {
    content: '';
    position: absolute;
    bottom: 0;
    left: 0;
    width: 100%;
    height: 2px;
    background: rgba(255, 255, 255, 0.2);
}

.attendance-table td {
    color: #334155;
    font-weight: 500;
}

.attendance-table tr {
    transition: all 0.3s ease;
}

.attendance-table tbody tr:hover {
    background: rgba(59, 130, 246, 0.04);
    transform: scale(1.002);
}

.attendance-table tbody tr:last-child td {
    border-bottom: none;
}

.present-btn {
    background: linear-gradient(135deg, #10b981 0%, #059669 100%);
    color: white;
    border: none;
    padding: 12px 24px;
    border-radius: 14px;
    cursor: pointer;
    font-size: 0.95rem;
    font-weight: 700;
    transition: all 0.4s cubic-bezier(0.23, 1, 0.32, 1);
    box-shadow: 0 6px 20px -4px rgba(16, 185, 129, 0.4);
    text-transform: uppercase;
    letter-spacing: 0.5px;
    position: relative;
    overflow: hidden;
}

.present-btn::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
    transition: left 0.6s ease;
}

.present-btn:hover::before {
    left: 100%;
}

.present-btn:hover {
    background: linear-gradient(135deg, #059669 0%, #047857 100%);
    transform: translateY(-2px) scale(1.05);
    box-shadow: 0 12px 35px -4px rgba(16, 185, 129, 0.5);
}

.present-btn:disabled {
    background: linear-gradient(135deg, #9ca3af 0%, #6b7280 100%);
    cursor: not-allowed;
    transform: none;
    box-shadow: 0 4px 15px -4px rgba(156, 163, 175, 0.3);
    opacity: 0.6;
}

.present-btn:disabled::before {
    display: none;
}

.export-section {
    margin-top: 60px;
    padding: 50px;
    background: 
        linear-gradient(135deg, rgba(248, 250, 252, 0.8) 0%, rgba(241, 245, 249, 0.8) 100%);
    backdrop-filter: blur(20px);
    border-radius: 24px;
    border: 1px solid rgba(59, 130, 246, 0.08);
    box-shadow: 0 20px 50px -12px rgba(0, 0, 0, 0.08);
    position: relative;
    overflow: hidden;
}

.export-section::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 4px;
    background: linear-gradient(90deg, #3b82f6 0%, #8b5cf6 50%, #06b6d4 100%);
    background-size: 200% 100%;
    animation: section-shimmer 4s ease-in-out infinite;
}

@keyframes section-shimmer {
    0%, 100% { background-position: 200% 0; }
    50% { background-position: -200% 0; }
}

.export-section::after {
    content: '';
    position: absolute;
    bottom: 20px;
    right: 20px;
    width: 100px;
    height: 100px;
    background: radial-gradient(circle, rgba(59, 130, 246, 0.05) 0%, transparent 70%);
    border-radius: 50%;
    animation: pulse-dot 3s ease-in-out infinite;
}

@keyframes pulse-dot {
    0%, 100% { transform: scale(1); opacity: 0.3; }
    50% { transform: scale(1.2); opacity: 0.1; }
}

.export-section h2 {
    margin-bottom: 35px;
    position: relative;
}

.date-picker {
    display: flex;
    gap: 30px;
    align-items: center;
    margin-bottom: 40px;
    flex-wrap: wrap;
    position: relative;
}

.date-picker::before {
    content: '';
    position: absolute;
    top: -10px;
    left: -20px;
    right: -20px;
    bottom: -10px;
    background: linear-gradient(135deg, rgba(59, 130, 246, 0.02) 0%, transparent 50%, rgba(30, 64, 175, 0.02) 100%);
    border-radius: 16px;
    z-index: -1;
}

.date-picker label {
    font-weight: 600;
    color: #374151;
    font-size: 1.05rem;
    position: relative;
}

.date-picker label::after {
    content: '';
    position: absolute;
    bottom: -4px;
    left: 0;
    width: 100%;
    height: 2px;
    background: linear-gradient(90deg, #3b82f6, transparent);
    border-radius: 1px;
    opacity: 0;
    transition: opacity 0.3s ease;
}

.date-picker:hover label::after {
    opacity: 1;
}

.date-picker input[type="date"] {
    padding: 18px 24px;
    border: 2px solid rgba(59, 130, 246, 0.1);
    border-radius: 18px;
    font-size: 1.05rem;
    transition: all 0.4s cubic-bezier(0.23, 1, 0.32, 1);
    background: rgba(255, 255, 255, 0.8);
    backdrop-filter: blur(10px);
    color: #374151;
    font-weight: 500;
    position: relative;
}

.date-picker input[type="date"]:focus {
    outline: none;
    border-color: #3b82f6;
    background: rgba(255, 255, 255, 0.95);
    box-shadow: 
        0 0 0 4px rgba(59, 130, 246, 0.1), 
        0 8px 30px -8px rgba(59, 130, 246, 0.2);
    transform: translateY(-2px);
}

.date-picker input[type="date"]::-webkit-calendar-picker-indicator {
    filter: invert(0.3) sepia(1) saturate(2) hue-rotate(200deg);
    cursor: pointer;
    transition: all 0.3s ease;
}

.date-picker input[type="date"]:hover::-webkit-calendar-picker-indicator {
    filter: invert(0.4) sepia(1) saturate(3) hue-rotate(200deg);
    transform: scale(1.1);
}

.error-message {
    color: #ef4444;
    text-align: center;
    margin-top: 35px;
    font-weight: 600;
    padding: 24px;
    background: 
        linear-gradient(135deg, rgba(239, 68, 68, 0.05) 0%, rgba(220, 38, 38, 0.05) 100%);
    backdrop-filter: blur(10px);
    border-radius: 18px;
    border: 2px solid rgba(239, 68, 68, 0.1);
    position: relative;
    overflow: hidden;
    animation: error-appear 0.5s ease-out;
}

@keyframes error-appear {
    from {
        opacity: 0;
        transform: translateY(20px) scale(0.95);
    }
    to {
        opacity: 1;
        transform: translateY(0) scale(1);
    }
}

.error-message::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 4px;
    animation: error-pulse 2s ease-in-out infinite;
}

@keyframes error-pulse {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.5; }
}

.success-message {
    color: #10b981;
    text-align: center;
    margin-top: 35px;
    font-weight: 600;
    padding: 24px;
    background: 
        linear-gradient(135deg, rgba(16, 185, 129, 0.05) 0%, rgba(5, 150, 105, 0.05) 100%);
    backdrop-filter: blur(10px);
    border-radius: 18px;
    border: 2px solid rgba(16, 185, 129, 0.1);
    position: relative;
    overflow: hidden;
    animation: success-appear 0.5s ease-out;
}

@keyframes success-appear {
    from {
        opacity: 0;
        transform: translateY(20px) scale(0.95);
    }
    to {
        opacity: 1;
        transform: translateY(0) scale(1);
    }
}

.success-message::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 4px;
    background: linear-gradient(90deg, #10b981 0%, #059669 100%);
    animation: success-shimmer 2s ease-in-out infinite;
}

@keyframes success-shimmer {
    0%, 100% { transform: translateX(-100%); }
    50% { transform: translateX(100%); }
}

.loading {
    text-align: center;
    padding: 100px;
    color: #64748b;
    font-size: 1.3rem;
    font-weight: 600;
    position: relative;
}

.loading::before {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    width: 50px;
    height: 50px;
    margin: -25px 0 0 -25px;
    border: 4px solid rgba(59, 130, 246, 0.1);
    border-top: 4px solid #3b82f6;
    border-radius: 50%;
    animation: loading-spin 1s linear infinite;
}

@keyframes loading-spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}

#currentDate {
    color: #3b82f6;
    font-weight: 700;
    text-shadow: 0 2px 10px rgba(59, 130, 246, 0.2);
    position: relative;
}

#currentDate::before {
    content: '';
    position: absolute;
    bottom: -2px;
    left: 0;
    width: 100%;
    height: 2px;
    background: linear-gradient(90deg, #3b82f6, #8b5cf6);
    border-radius: 1px;
    animation: date-glow 3s ease-in-out infinite;
}

@keyframes date-glow {
    0%, 100% { opacity: 0.5; }
    50% { opacity: 1; }
}

#userName {
    font-weight: 700;
    color: #1e293b;
    position: relative;
}

#userName::first-letter {
    color: #3b82f6;
    font-size: 1.2em;
    text-shadow: 0 2px 10px rgba(59, 130, 246, 0.3);
}

/* Enhanced Responsive Design */
@media (max-width: 1200px) {
    .container {
        margin: 25px;
        width: calc(100% - 50px);
        min-height: 750px;
    }
    
    .main-app {
        padding: 45px;
    }
    
    .students-grid {
        grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
        gap: 28px;
    }
    
    .header h1 {
        font-size: 2.7rem;
    }
    
    .login-section h1 {
        font-size: 4rem;
    }
}

@media (max-width: 1024px) {
    .container {
        margin: 20px;
        width: calc(100% - 40px);
    }
    
    .main-app {
        padding: 40px;
    }
    
    .header {
        flex-direction: column;
        gap: 25px;
        text-align: center;
        padding: 35px 0;
    }
    
    .header h1 {
        font-size: 2.5rem;
    }
    
    .students-grid {
        grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
        gap: 25px;
    }
    
    .tabs {
        flex-wrap: wrap;
        gap: 12px;
    }
    
    .tab {
        flex: 1;
        min-width: 150px;
    }
}

@media (max-width: 768px) {
    .container {
        margin: 15px;
        width: calc(100% - 30px);
        border-radius: 24px;
    }
    
    .login-section {
        padding: 80px 50px;
        border-radius: 24px 24px 0 0;
    }
    
    .login-section h1 {
        font-size: 3.5rem;
        margin-bottom: 35px;
    }
    
    .login-section p {
        font-size: 1.25rem;
        margin-bottom: 45px;
    }
    
    .google-login-btn {
        padding: 20px 42px;
        font-size: 1.1rem;
    }
    
    .main-app {
        padding: 35px;
    }
    
    .header h1 {
        font-size: 2.2rem;
    }
    
    .students-grid {
        grid-template-columns: 1fr;
        gap: 22px;
    }
    
    .student-card {
        padding: 30px;
    }
    
    .tabs {
        flex-direction: column;
        gap: 10px;
        padding: 16px;
    }
    
    .tab {
        width: 100%;
        text-align: center;
        padding: 16px 24px;
    }
    
    .date-picker {
        flex-direction: column;
        align-items: stretch;
        gap: 20px;
    }
    
    .attendance-table {
        font-size: 0.95rem;
    }
    
    .attendance-table th,
    .attendance-table td {
        padding: 20px 22px;
    }
    
    .export-section {
        padding: 40px;
        margin-top: 50px;
    }
    
    .user-info {
        flex-direction: column;
        gap: 16px;
        padding: 20px;
    }
    
    .user-info div {
        text-align: center;
    }
}

@media (max-width: 640px) {
    .login-section {
        padding: 60px 35px;
    }
    
    .login-section h1 {
        font-size: 3rem;
    }
    
    .main-app {
        padding: 25px;
    }
    
    .header {
        padding: 25px 0;
        margin-bottom: 40px;
    }
    
    .header h1 {
        font-size: 1.9rem;
    }
    
    .student-card {
        padding: 25px;
    }
    
    .student-actions {
        flex-direction: column;
        gap: 12px;
    }
    
    .attendance-table {
        font-size: 0.9rem;
    }
    
    .attendance-table th,
    .attendance-table td {
        padding: 16px 18px;
    }
    
    .export-section {
        padding: 30px;
    }
    
    .tab-content h2 {
        font-size: 1.9rem;
    }
}

@media (max-width: 480px) {
    .container {
        margin: 10px;
        width: calc(100% - 20px);
        border-radius: 20px;
    }
    
    .login-section {
        padding: 50px 25px;
        border-radius: 20px 20px 0 0;
    }
    
    .login-section h1 {
        font-size: 2.5rem;
        margin-bottom: 30px;
    }
    
    .login-section p {
        font-size: 1.15rem;
        margin-bottom: 40px;
    }
    
    .google-login-btn {
        padding: 18px 36px;
        font-size: 1rem;
        gap: 14px;
    }
    
    .main-app {
        padding: 20px;
    }
    
    .header h1 {
        font-size: 1.7rem;
    }
    
    .student-card {
        padding: 20px;
        border-radius: 18px;
    }
    
    .student-card h3 {
        font-size: 1.3rem;
        margin-bottom: 20px;
    }
    
    .attendance-table {
        font-size: 0.85rem;
        border-radius: 18px;
    }
    
    .attendance-table th,
    .attendance-table td {
        padding: 14px 16px;
    }
    
    .export-section {
        padding: 25px;
        border-radius: 18px;
    }
    
    .form-group input {
        padding: 16px 20px;
        border-radius: 14px;
    }
    
    .btn {
        padding: 14px 28px;
        border-radius: 14px;
        font-size: 0.95rem;
        margin-bottom: 12px;
        margin-right: 0;
        width: 100%;
    }
    
    .present-btn {
        padding: 10px 18px;
        font-size: 0.85rem;
        border-radius: 12px;
    }
    
    .tab-content h2 {
        font-size: 1.7rem;
        margin-bottom: 30px;
    }
    
    .user-avatar {
        width: 48px;
        height: 48px;
    }
    
    .logout-btn {
        padding: 12px 24px;
        font-size: 0.85rem;
        border-radius: 14px;
    }
}

    </style>
</head>
<body>
    <div id="floating-container"></div>
    <div class="container">
        <!-- Login Section -->
        <div id="loginSection" class="login-section">
            <h1>Attendance Management System</h1>
            <p>Please sign in with your Google account to access the attendance system. Only authorized users can access this system.</p>
            <button id="googleLoginBtn" class="google-login-btn">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="#4285F4">
                    <path d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/>
                    <path d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/>
                    <path d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/>
                    <path d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/>
                </svg>
                Sign in with Google
            </button>
            <div id="errorMessage" class="error-message"></div>
        </div>

        <!-- Main Application -->
        <div id="mainApp" class="main-app">
            <div class="header">
                <h1>Attendance System</h1>
                <div class="user-info">
                    <img id="userAvatar" class="user-avatar" src="" alt="User">
                    <span id="userName"></span>
                    <button id="logoutBtn" class="logout-btn">Logout</button>
                </div>
            </div>

            <div class="tabs">
                <button class="tab active" onclick="showTab('students')">Manage Students</button>
                <button class="tab" onclick="showTab('attendance')">Mark Attendance</button>
                <button class="tab" onclick="showTab('reports')">Reports</button>
            </div>

            <!-- Students Tab -->
            <div id="studentsTab" class="tab-content active">
                <h2>Add New Student</h2>
                <form id="studentForm">
                    <div class="form-group">
                        <label for="studentName">Student Name:</label>
                        <input type="text" id="studentName" required>
                    </div>
                    <div class="form-group">
                        <label for="studentId">Student ID:</label>
                        <input type="text" id="studentId" required>
                    </div>
                    <div class="form-group">
                        <label for="studentPhone">Phone Number:</label>
                        <input type="tel" id="studentPhone" required>
                    </div>
                    <button type="submit" class="btn">Add Student</button>
                </form>

                <div class="students-grid" id="studentsGrid">
                    <!-- Students will be populated here -->
                </div>
            </div>

            <!-- Attendance Tab -->
            <div id="attendanceTab" class="tab-content">
                <h2>Mark Attendance - <span id="currentDate"></span></h2>
                <table class="attendance-table">
                    <thead>
                        <tr>
                            <th>Student Name</th>
                            <th>Student ID</th>
                            <th>Phone</th>
                            <th>Status</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody id="attendanceTableBody">
                        <!-- Attendance rows will be populated here -->
                    </tbody>
                </table>
            </div>

            <!-- Reports Tab -->
            <div id="reportsTab" class="tab-content">
                <div class="export-section">
                    <h2>Attendance Reports</h2>
                    <div class="date-picker">
                        <label for="fromDate">From:</label>
                        <input type="date" id="fromDate">
                        <label for="toDate">To:</label>
                        <input type="date" id="toDate">
                        <button class="btn" onclick="generateReport()">Generate Report</button>
                        <button class="btn btn-success" onclick="exportToCSV()">Export to CSV</button>
                    </div>
                    <div id="reportContainer">
                        <!-- Report will be displayed here -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>

    <script>
    const firebaseConfig = {
       apiKey: "",
        authDomain: "",
        projectId: "",
        storageBucket: "",
        messagingSenderId: "",
        appId: ""//all of ur firebase credentials
};

firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const db = firebase.firestore();

let currentUser = null;
let students = [];
let attendanceData = [];

const loginSection = document.getElementById('loginSection');
const mainApp = document.getElementById('mainApp');
const googleLoginBtn = document.getElementById('googleLoginBtn');
const logoutBtn = document.getElementById('logoutBtn');
const errorMessage = document.getElementById('errorMessage');
const studentForm = document.getElementById('studentForm');
const studentsGrid = document.getElementById('studentsGrid');
const attendanceTableBody = document.getElementById('attendanceTableBody');
const currentDateSpan = document.getElementById('currentDate');

currentDateSpan.textContent = new Date().toLocaleDateString();

googleLoginBtn.addEventListener('click', async () => {
    try {
        const provider = new firebase.auth.GoogleAuthProvider();
        const result = await auth.signInWithPopup(provider);
        const user = result.user;
        
        const userDoc = await db.collection('users').doc(user.uid).get();
        
        if (!userDoc.exists) {
            await db.collection('users').doc(user.uid).set({
                email: user.email,
                displayName: user.displayName,
                photoURL: user.photoURL,
                authorized: true,
                createdAt: firebase.firestore.FieldValue.serverTimestamp()
            });
        }
        
        currentUser = user;
        showMainApp();
        loadStudents();
        
    } catch (error) {
        console.error('Login error:', error);
        showError('Login failed: ' + error.message);
    }
});

logoutBtn.addEventListener('click', async () => {
    try {
        await auth.signOut();
        currentUser = null;
        showLoginSection();
    } catch (error) {
        console.error('Logout error:', error);
        showError('Logout failed: ' + error.message);
    }
});

studentForm.addEventListener('submit', async (e) => {
    e.preventDefault();
    
    const name = document.getElementById('studentName').value;
    const id = document.getElementById('studentId').value;
    const phone = document.getElementById('studentPhone').value;
    
    const existingStudent = students.find(s => s.id === id);
    if (existingStudent) {
        showError('Student ID already exists! Please use a different ID.');
        return;
    }
    
    try {
        const studentData = {
            name: name,
            id: id,
            phone: phone,
            createdAt: firebase.firestore.FieldValue.serverTimestamp()
        };
        
        await db.collection('users').doc(currentUser.uid).collection('students').add(studentData);
        
        studentForm.reset();
        showSuccess('Student added successfully!');
        loadStudents();
        
    } catch (error) {
        console.error('Error adding student:', error);
        showError('Failed to add student: ' + error.message);
    }
});

async function loadStudents() {
    try {
        const snapshot = await db.collection('users').doc(currentUser.uid).collection('students').get();
        
        students = [];
        snapshot.forEach(doc => {
            students.push({ docId: doc.id, ...doc.data() });
        });
        
        displayStudents();
        updateAttendanceTable();
        
    } catch (error) {
        console.error('Error loading students:', error);
        showError('Failed to load students: ' + error.message);
    }
}

function displayStudents() {
    studentsGrid.innerHTML = '';
    
    students.forEach(student => {
        const studentCard = document.createElement('div');
        studentCard.className = 'student-card';
        studentCard.innerHTML = `
            <h3>${student.name}</h3>
            <p><strong>ID:</strong> ${student.id}</p>
            <p><strong>Phone:</strong> ${student.phone}</p>
            <div class="student-actions">
                <button class="btn btn-danger" onclick="deleteStudent('${student.docId}')">Delete</button>
            </div>
        `;
        studentsGrid.appendChild(studentCard);
    });
}

async function deleteStudent(docId) {
    if (confirm('Are you sure you want to delete this student?')) {
        try {
            await db.collection('users').doc(currentUser.uid).collection('students').doc(docId).delete();
            showSuccess('Student deleted successfully!');
            loadStudents();
        } catch (error) {
            console.error('Error deleting student:', error);
            showError('Failed to delete student: ' + error.message);
        }
    }
}

function updateAttendanceTable() {
    attendanceTableBody.innerHTML = '';
    
    students.forEach(student => {
        const row = document.createElement('tr');
        const today = new Date().toISOString().split('T')[0];
        const isPresent = attendanceData.some(a => 
            a.studentId === student.id && a.date === today
        );
        
        row.innerHTML = `
            <td>${student.name}</td>
            <td>${student.id}</td>
            <td>${student.phone}</td>
            <td>${isPresent ? 'Present' : 'Absent'}</td>
            <td>
                <button class="present-btn" 
                        onclick="markPresent('${student.id}')"
                        ${isPresent ? 'disabled' : ''}>
                    ${isPresent ? 'Already Present' : 'Mark Present'}
                </button>
            </td>
        `;
        attendanceTableBody.appendChild(row);
    });
}

async function markPresent(studentId) {
    try {
        const today = new Date().toISOString().split('T')[0];
        
        const attendanceRecord = {
            studentId: studentId,
            date: today,
            timestamp: firebase.firestore.FieldValue.serverTimestamp()
        };
        
        await db.collection('users').doc(currentUser.uid).collection('attendance').add(attendanceRecord);
        
        attendanceData.push(attendanceRecord);
        updateAttendanceTable();
        
        showSuccess('Attendance marked successfully!');
        
    } catch (error) {
        console.error('Error marking attendance:', error);
        showError('Failed to mark attendance: ' + error.message);
    }
}

async function loadAttendanceData() {
    try {
        const snapshot = await db.collection('users').doc(currentUser.uid).collection('attendance').get();
        
        attendanceData = [];
        snapshot.forEach(doc => {
            attendanceData.push({ docId: doc.id, ...doc.data() });
        });
        
        updateAttendanceTable();
        
    } catch (error) {
        console.error('Error loading attendance data:', error);
        showError('Failed to load attendance data: ' + error.message);
    }
}

async function generateReport() {
    const fromDate = document.getElementById('fromDate').value;
    const toDate = document.getElementById('toDate').value;
    
    if (!fromDate || !toDate) {
        showError('Please select both from and to dates.');
        return;
    }
    
    try {
        const snapshot = await db.collection('users').doc(currentUser.uid).collection('attendance')
            .where('date', '>=', fromDate)
            .where('date', '<=', toDate)
            .get();
        
        const reportData = {};
        snapshot.forEach(doc => {
            const data = doc.data();
            if (!reportData[data.studentId]) {
                reportData[data.studentId] = {
                    student: students.find(s => s.id === data.studentId),
                    presentDays: []
                };
            }
            reportData[data.studentId].presentDays.push(data.date);
        });
        
        displayReport(reportData, fromDate, toDate);
        
    } catch (error) {
        console.error('Error generating report:', error);
        showError('Failed to generate report: ' + error.message);
    }
}

function displayReport(reportData, fromDate, toDate) {
    const reportContainer = document.getElementById('reportContainer');
    
    let html = `
        <h3>Attendance Report (${fromDate} to ${toDate})</h3>
        <table class="attendance-table">
            <thead>
                <tr>
                    <th>Student Name</th>
                    <th>Student ID</th>
                    <th>Days Present</th>
                    <th>Attendance Rate</th>
                </tr>
            </thead>
            <tbody>
    `;
    
    const totalDays = Math.ceil((new Date(toDate) - new Date(fromDate)) / (1000 * 60 * 60 * 24)) + 1;
    
    Object.values(reportData).forEach(studentData => {
        const student = studentData.student;
        const presentDays = studentData.presentDays.length;
        const attendanceRate = ((presentDays / totalDays) * 100).toFixed(1);
        
        html += `
            <tr>
                <td>${student?.name || 'Unknown'}</td>
                <td>${student?.id || 'Unknown'}</td>
                <td>${presentDays}</td>
                <td>${attendanceRate}%</td>
            </tr>
        `;
    });
    
    html += '</tbody></table>';
    reportContainer.innerHTML = html;
}

async function exportToCSV() {
    const fromDate = document.getElementById('fromDate').value;
    const toDate = document.getElementById('toDate').value;
    
    if (!fromDate || !toDate) {
        showError('Please select dates and generate report first.');
        return;
    }
    
    try {
        const snapshot = await db.collection('users').doc(currentUser.uid).collection('attendance')
            .where('date', '>=', fromDate)
            .where('date', '<=', toDate)
            .get();
        
        const reportData = {};
        snapshot.forEach(doc => {
            const data = doc.data();
            if (!reportData[data.studentId]) {
                reportData[data.studentId] = {
                    student: students.find(s => s.id === data.studentId),
                    presentDays: []
                };
            }
            reportData[data.studentId].presentDays.push(data.date);
        });
        
        const totalDays = Math.ceil((new Date(toDate) - new Date(fromDate)) / (1000 * 60 * 60 * 24)) + 1;
        
        let csvContent = "Student Name,Student ID,Phone,Days Present,Total Days,Attendance Rate\n";
        
        Object.values(reportData).forEach(studentData => {
            const student = studentData.student;
            const presentDays = studentData.presentDays.length;
            const attendanceRate = ((presentDays / totalDays) * 100).toFixed(1);
            
            csvContent += `"${student?.name || 'Unknown'}","${student?.id || 'Unknown'}","${student?.phone || 'Unknown'}",${presentDays},${totalDays},${attendanceRate}%\n`;
        });
        
        const blob = new Blob([csvContent], { type: 'text/csv' });
        const url = window.URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `attendance_report_${fromDate}_to_${toDate}.csv`;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        window.URL.revokeObjectURL(url);
        
        showSuccess('CSV file downloaded successfully!');
        
    } catch (error) {
        console.error('Error exporting to CSV:', error);
        showError('Failed to export CSV: ' + error.message);
    }
}

function showLoginSection() {
    loginSection.style.display = 'flex';
    mainApp.style.display = 'none';
    errorMessage.textContent = '';
}

function showMainApp() {
    loginSection.style.display = 'none';
    mainApp.style.display = 'block';
    
    document.getElementById('userAvatar').src = currentUser.photoURL || '';
    document.getElementById('userName').textContent = currentUser.displayName || '';
    
    loadAttendanceData();
}

function showTab(tabName) {
    document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
    document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
    
    event.target.classList.add('active');
    document.getElementById(tabName + 'Tab').classList.add('active');
}

function showError(message) {
    errorMessage.textContent = message;
    errorMessage.style.display = 'block';
    setTimeout(() => {
        errorMessage.textContent = '';
        errorMessage.style.display = 'none';
    }, 5000);
}

function showSuccess(message) {
    const successDiv = document.createElement('div');
    successDiv.className = 'success-message';
    successDiv.textContent = message;
    successDiv.style.cssText = `
        position: fixed;
        top: 20px;
        right: 20px;
        background: #4CAF50;
        color: white;
        padding: 15px 20px;
        border-radius: 5px;
        z-index: 1000;
        box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    `;
    document.body.appendChild(successDiv);
    
    setTimeout(() => {
        if (document.body.contains(successDiv)) {
            document.body.removeChild(successDiv);
        }
    }, 3000);
}

async function addUserToCollection(userUid, userData = {}) {
    try {
        await db.collection('users').doc(userUid).set({
            authorized: true,
            createdAt: firebase.firestore.FieldValue.serverTimestamp(),
            ...userData
        });
    } catch (error) {
        console.error('Error adding user to collection:', error);
    }
}

auth.onAuthStateChanged(async (user) => {
    if (user) {
        try {
            const userDoc = await db.collection('users').doc(user.uid).get();
            
            if (!userDoc.exists) {
                await db.collection('users').doc(user.uid).set({
                    email: user.email,
                    displayName: user.displayName,
                    photoURL: user.photoURL,
                    authorized: true,
                    createdAt: firebase.firestore.FieldValue.serverTimestamp()
                });
            }
            
            currentUser = user;
            showMainApp();
            loadStudents();
            
        } catch (error) {
            console.error('Error checking user authorization:', error);
            showError('Error checking user authorization: ' + error.message);
        }
    } else {
        currentUser = null;
        showLoginSection();
    }
});

window.addUserToCollection = addUserToCollection;
    </script>
</body>
</html>
